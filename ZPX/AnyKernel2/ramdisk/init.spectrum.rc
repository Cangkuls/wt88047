# SPECTRUM KERNEL MANAGER
# Ramdisk file for profile based kernel management
# Implimentation inspired by Franco's fku profiles

# Initialization
on property:sys.boot_completed=1
   # Set default profile on first boot
   exec u:r:init:s0 root root -- /init.spectrum.sh
   exec u:r:su:s0 root root -- /init.spectrum.sh
   # Enable Spectrum support
   setprop spectrum.support 1
   # Add kernel name
   setprop persist.spectrum.kernel Excalibur

# Balance (default profile)
on property:persist.spectrum.profile=0
   stop logd
   write /sys/android_touch/doubletap2wake 1
   write /sys/class/timed_output/vibrator/vtg_level 19
   write /sys/module/cpu_boost/parameters/sync_threshold 0
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpufreq/interactive/io_is_busy 1
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq 302400
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu1/online 1
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq 302400
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu2/online 1
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq 302400
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu3/online 1
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq 302400
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq 1363200
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq 1363200
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq 1363200
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq 1363200
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq
   write /sys/module/cpu_boost/parameters/sync_threshold 998400
   chmod 0664 /sys/module/lazyplug/parameters/nr_run_profiles_sel
   write /sys/module/lazyplug/parameters/nr_run_profiles_sel 6
   write /sys/module/lazyplug/parameters/nr_run_hysteresis 4
   write /sys/module/msm_thermal/parameters/temp_threshold 50
   write /sys/module/msm_perfomance/parameters/touchboost 1
   write /sys/module/cpu_boost/parameters/input_boost_enabled 1
   write /sys/module/cpu_boost/parameters/input_boost_freq "0:998400 1:998400 2:0 3:0"
   write /sys/module/lowmemorykiller/parameters/minfree "1024,2048,4096,8192,12288,16384"
   write /sys/block/mmcblk0/queue/rq_affinity 1
   write /sys/block/mmcblk1/queue/rq_affinity 1
   write /sys/block/mmcblk0/queue/scheduler zen
   write /sys/block/mmcblk1/queue/scheduler zen
   write /sys/block/mmcblk0/queue/read_ahead_kb 128
   write /sys/block/mmcblk1/queue/read_ahead_kb 128
   write /sys/class/kgsl/kgsl-3d0/devfreq/min_freq 100000000
   write /sys/devices/soc.0/1c00000.qcom,kgsl-3d0/kgsl/kgsl-3d0/max_gpuclk 400000000
   write /sys/devices/soc.0/1c00000.qcom,kgsl-3d0/devfreq/1c00000.qcom,kgsl-3d0/governor msm-adreno-tz

# Performance (based on DrunkSauce Lite)
on property:persist.spectrum.profile=1
   stop logd
   write /sys/android_touch/doubletap2wake 1
   write /sys/class/timed_output/vibrator/vtg_level 19
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq 533333
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu1/online 1
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq 533333
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu2/online 1
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq 533333
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu3/online 1
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq 533333
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq 1401600
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq 1401600
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq 1401600
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq 1401600
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq
   write /sys/module/cpu_boost/parameters/sync_threshold 0
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor
   write /sys/module/msm_perfomance/parameters/touchboost 1
   write /sys/module/cpu_boost/parameters/input_boost_enabled 1
   write /sys/module/cpu_boost/parameters/input_boost_freq "0:1094400 1:1094400 2:1094400 3:1094400"
   write /sys/devices/system/cpu/cpufreq/interactive/io_is_busy 1
   write /sys/module/lowmemorykiller/parameters/minfree "1024,2048,4096,8192,12288,16384"
   chmod 0664 /sys/module/lazyplug/parameters/nr_run_profiles_sel
   write /sys/module/lazyplug/parameters/nr_run_profiles_sel 6
   write /sys/module/lazyplug/parameters/nr_run_hysteresis 4
   write /sys/block/mmcblk0/queue/rq_affinity 2
   write /sys/block/mmcblk0/queue/rq_affinity 2
   write /sys/block/mmcblk0/queue/scheduler deadline
   write /sys/block/mmcblk1/queue/scheduler deadline
   write /sys/block/mmcblk0/queue/read_ahead_kb 512
   write /sys/block/mmcblk1/queue/read_ahead_kb 512
   write /sys/class/kgsl/kgsl-3d0/devfreq/min_freq 100000000
   write /sys/devices/soc.0/1c00000.qcom,kgsl-3d0/kgsl/kgsl-3d0/max_gpuclk 465000000
   write /sys/devices/soc.0/1c00000.qcom,kgsl-3d0/devfreq/1c00000.qcom,kgsl-3d0/governor performance

# Battery
on property:persist.spectrum.profile=2
   stop logd
   write /sys/android_touch/doubletap2wake 1
   write /sys/class/timed_output/vibrator/vtg_level 19
   write /sys/module/cpu_boost/parameters/sync_threshold 0
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor powersave
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor powersave
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor powersave
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor powersave
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq 200000
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu1/online 1
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq 200000
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu2/online 1
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq 200000
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu3/online 1
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq 200000
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq 1094400
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq 1094400
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq 1094400
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq 1094400
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpufreq/interactive/io_is_busy 0
   chown system system /sys/module/lazyplug/parameters/nr_run_profiles_sel
   chmod 0664 /sys/module/lazyplug/parameters/nr_run_profiles_sel
   write /sys/module/lazyplug/parameters/nr_run_profiles_sel 0
   write /sys/module/lazyplug/parameters/nr_run_hysteresis 4
   write /sys/module/msm_perfomance/parameters/touchboost 0
   write /sys/module/cpu_boost/parameters/sync_threshold 998400
   write /sys/devices/system/cpu/cpufreq/interactive/boost 0
   write /sys/devices/system/cpu/cpufreq/interactive/boostpulse_duration 0
   write /sys/devices/system/cpu/cpufreq/interactive/target_loads 1 800000:85 998400:90 1094400:80
   write /sys/devices/system/cpu/cpufreq/interactive/go_highspeed_load 99
   write /sys/devices/system/cpu/cpufreq/interactive/above_hispeed_delay 25000
   write /sys/devices/system/cpu/cpufreq/interactive/align_windows 0
   write /sys/devices/system/cpu/cpufreq/interactive/max_freq_hysteresis 0
   write /sys/devices/system/cpu/cpufreq/interactive/target_loads 99
   write /sys/devices/system/cpu/cpufreq/interactive/min_sample_time 10000
   write /sys/devices/system/cpu/cpufreq/interactive/timer_rate 10000
   write /sys/devices/system/cpu/cpufreq/interactive/timer_slack 80000
   write /sys/devices/system/cpu/cpufreq/interactive/use_migration_notif 0
   write /sys/devices/system/cpu/cpufreq/interactive/use_sched_load 0
   write /sys/devices/system/cpu/cpufreq/interactive/hispeed_freq 1094400
   write /sys/module/cpu_boost/parameters/input_boost_enabled 0
   write /sys/module/cpu_boost/parameters/input_boost_freq "0:0 1:0 2:0 3:0"
   write /sys/module/lowmemorykiller/parameters/minfree "4096,8192,16384,32768,49152,65536"
   write /sys/block/mmcblk0/queue/rq_affinity 0
   write /sys/block/mmcblk0/queue/rq_affinity 0
   write /sys/block/mmcblk0/queue/scheduler noop
   write /sys/block/mmcblk1/queue/scheduler noop
   write /sys/block/mmcblk0/queue/read_ahead_kb 128
   write /sys/block/mmcblk1/queue/read_ahead_kb 128
   write /sys/class/kgsl/kgsl-3d0/devfreq/min_freq 50000000
   write /sys/devices/soc.0/1c00000.qcom,kgsl-3d0/kgsl/kgsl-3d0/max_gpuclk 310000000
   write /sys/devices/soc.0/1c00000.qcom,kgsl-3d0/devfreq/1c00000.qcom,kgsl-3d0/governor msm-adreno-tz

# Gaming
on property:persist.spectrum.profile=3
   stop logd
   write /sys/android_touch/doubletap2wake 1
   write /sys/class/timed_output/vibrator/vtg_level 19
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq 800000
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu1/online 1
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq 800000
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu2/online 1
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq 800000
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu3/online 1
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq 800000
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_min_freq
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq 1401600
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq 1401600
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq 1401600
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_max_freq
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq 1401600
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_max_freq
   write /sys/module/cpu_boost/parameters/sync_threshold 0
   chmod 644 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu1/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu2/cpufreq/scaling_governor
   chmod 644 /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor
   write /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor interactive
   chmod 444 /sys/devices/system/cpu/cpu3/cpufreq/scaling_governor
   write /sys/module/msm_perfomance/parameters/touchboost 1
   write /sys/module/cpu_boost/parameters/sync_threshold 0
   write /sys/module/cpu_boost/parameters/input_boost_enabled 1
   write /sys/module/cpu_boost/parameters/input_boost_freq "0:1094400 1:1094400 2:1094400 3:1094400"
   write /sys/devices/system/cpu/cpufreq/interactive/boost 1
   write /sys/devices/system/cpu/cpufreq/interactive/boostpulse_duration 80000
   write /sys/devices/system/cpu/cpufreq/interactive/go_hispeed_load 60
   write /sys/devices/system/cpu/cpufreq/interactive/use_sched_load 1
   write /sys/devices/system/cpu/cpufreq/interactive/use_migration_notif 1
   write /sys/module/lowmemorykiller/parameters/minfree "1024,2048,4096,8192,12288,16384"
   chown system system /sys/module/lazyplug/parameters/nr_run_profiles_sel
   chmod 0664 /sys/module/lazyplug/parameters/nr_run_profiles_sel
   write /sys/module/lazyplug/parameters/nr_run_profiles_sel 6
   write /sys/module/lazyplug/parameters/nr_run_hysteresis 4
   write /sys/module/lowmemorykiller/parameters/minfree "1024,2048,2560,4096,6144,8192"
   write /sys/block/mmcblk0/queue/rq_affinity 2
   write /sys/block/mmcblk1/queue/rq_affinity 2
   write /sys/block/mmcblk0/queue/scheduler row
   write /sys/block/mmcblk1/queue/scheduler row
   write /sys/block/mmcblk0/queue/read_ahead_kb 512
   write /sys/block/mmcblk1/queue/read_ahead_kb 512
   write /sys/class/kgsl/kgsl-3d0/devfreq/min_freq 200000000
   write /sys/devices/soc.0/1c00000.qcom,kgsl-3d0/kgsl/kgsl-3d0/max_gpuclk 465000000
   write /sys/devices/soc.0/1c00000.qcom,kgsl-3d0/devfreq/1c00000.qcom,kgsl-3d0/governor performance

